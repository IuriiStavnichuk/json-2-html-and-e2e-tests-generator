"use strict";angular.module("cedric",["cedric.controllers","cedric.directives","cedric.filters","SharedServices","AuthenticationServices"]).config(["$httpProvider","$routeProvider",function(a,b){b.when("/search",{templateUrl:"ng-partials/search.html",controller:"CedricSearch"}).when("/:referenceNumber",{templateUrl:"ng-partials/details.html",controller:"CedricDetails"}).otherwise({redirectTo:"/search"});var c=$('input[name="__RequestVerificationToken"]').val()||"";a.defaults.headers.common.__RequestVerificationToken=c}]).factory("CedricSearchValue",function(){return{caseNumber:""}});angular.module("cedric.controllers",[]).controller("CedricSearch",["$scope","$http","CedricSearchValue",function(b,a,c){b.searchParameter=c;b.currentPage=0;b.pageSize=10;b.ddlCaseReasons=[];b.ddlCountries=[];b.ddlAllStatus=[];b.ddlAccountTypes=[];b.cedricCases=[];a({method:"GET",url:"JSON/AuthorizationCases/GetAllCaseReason"}).success(function(d){b.ddlCaseReasons=d});a({method:"GET",url:"JSON/AuthorizationCases/GetSpecificCountry"}).success(function(d){b.ddlCountries=d});a({method:"GET",url:"JSON/AuthorizationCases/GetCaseStatus"}).success(function(d){b.ddlAllStatus=d});a({method:"GET",url:"JSON/AuthorizationCases/GetAllAccountType"}).success(function(d){b.ddlAccountTypes=d});b.updateSearch=function(e,d){a({method:"POST",url:"JSON/AuthorizationCases/GetSearch",data:e}).success(function(f){b.currentPage=d||0;b.cedricCases=f;if(typeof f[0]!=="undefined"){b.showResults="true"}else{b.showResults="false"}}).error(function(f){b.showResults="error"})};b.reset=function(){b.searchParameter={}};b.numberOfPages=function(){return Math.ceil(b.cedricCases.length/b.pageSize)}}]).controller("CedricDetails",["$scope","$routeParams","$http",function(c,b,a){c.cedricCaseDetails=[{}];c.isBusiness=false;c.isOwner=false;c.isIndian=false;c.hasCaseDocuments=false;c.needsUpdate=false;c.currentCaseId=-1;c.ddlDocumentReasons=[];c.updateDetailsView=function(){a({method:"GET",url:"JSON/AuthorizationCases/getCaseDetail/"+b.referenceNumber}).success(function(e){c.cedricCaseDetails=e;if(e!=="null"){var d;var f;c.showResults=true;if(c.cedricCaseDetails.isCaseAssignToMe===true){c.isOwner=c.cedricCaseDetails.caseStatus}c.currentCaseId=c.cedricCaseDetails.caseNumber;f=c.cedricCaseDetails.caseReason;d=c.cedricCaseDetails.accountType;c.updateCaseView();c.updateCaseHistory();if(d.indexOf("Business")>-1){c.isBusiness=true}if(f.indexOf("(IN)")>-1){c.isIndian=true}}else{c.showResults="false"}}).error(function(){c.showResults="error";$("loading").hide()})};c.takeThisCase=function(){a({method:"POST",url:"JSON/AuthorizationCases/AssignCase",data:{caseId:c.currentCaseId}}).success(function(d){if(d==400){c.isOwner=false;$(".caseTakenError").show()}c.updateDetailsView();c.updateCaseHistory()}).error(function(){})};c.updateCaseHistory=function(){c.hasCaseHistory=true;a({method:"GET",url:"JSON/AuthorizationCases/GetCaseLogs/"+c.currentCaseId}).success(function(d){c.cedricCaseHistories=d;if(d===""){c.hasCaseHistory=false}})};c.updateCaseView=function(){a({method:"GET",url:"JSON/AuthorizationCases/GetCaseDocuments/"+c.currentCaseId}).success(function(d){c.cedricDocuments=d}).error(function(){})};c.caseDeclineByDocumentCategory=function(d,e){a({method:"GET",url:"JSON/AuthorizationCases/GetAllDocumentResponseByDocumentCategoryId/"+d}).success(function(f){c.ddlDocumentReasons[e]=f})};a({method:"GET",url:"JSON/AuthorizationCases/GetAllDocumentType"}).success(function(d){c.mapDocumentTypes=d});a({method:"GET",url:"JSON/AuthorizationCases/GetAllStatus"}).success(function(d){c.ddlDocumentStatuses=d});c.change=function(){c.needsUpdate=true;$(".expirationDate").hide();$(".generalError").hide()};c.applyChanges=function(d){a({method:"POST",url:"JSON/AuthorizationCases/UpdateDocuments",data:d}).success(function(g){c.updateDetailsView();c.updateCaseHistory();c.needsUpdate=false;if(g==400){for(var e=0;e<d.length;e++){var f=d[e].expirationDate;if(f===null){$(".expirationDate").show()}else{$(".generalError").show()}}}if(g==202){$(".applyChangeSuccess").show()}}).error(function(){$(".generalError").show()})};c.updateDetailsView()}]).controller("XSSCall",["$scope","$http",function(b,a){a({method:"GET",url:"JSON/AuthorizationCases/XSS/"}).success(function(c){b.xss=c})}]);angular.module("cedric.directives",[]).directive("dateEntry",["$parse",function(a){return{restrict:"A",require:"ngModel",link:function(f,c,b,d){var e=f.$eval(b.dateEntry)||{};e.onSelect=function(g){f.$apply(function(){d.$setViewValue(c.val())})};c.datepick(e)}}}]);angular.module("cedric.filters",[]).filter("startFrom",function(){return function(a,b){b=+b;return a.slice(b)}});angular.module("SharedServices",[]).config(["$httpProvider",function(a){a.responseInterceptors.push("myHttpInterceptor");var b=function(c,d){$(".loading").show();return c};a.defaults.transformRequest.push(b)}]).factory("myHttpInterceptor",["$q","$window",function(a,b){return function(c){return c.then(function(d){$(".loading").hide();return d},function(d){$(".loading").hide();return a.reject(d)})}}]);angular.module("AuthenticationServices",[],["$routeProvider","$locationProvider","$httpProvider",function(c,b,a){var d=["$rootScope","$q",function(g,e){function h(i){return i}function f(i){var j=i.status;if(j==401){window.location="./login.aspx";return}return e.reject(i)}return function(i){return i.then(h,f)}}];a.responseInterceptors.push(d)}]);